# CONSENSUS_ç—›ç‚¹åˆ†æ”¯å±•ç¤º.md

## ğŸ¯ æ˜ç¡®çš„éœ€æ±‚æè¿°
å®ç°ç—›ç‚¹regenerateçš„åˆ†æ”¯å±•ç¤ºç³»ç»Ÿï¼Œæ¯ä¸ªç‰ˆæœ¬ç‹¬ç«‹å±•ç¤ºï¼Œæ•´ä¸ªworkflowåˆ†æ”¯å‘å±•ï¼Œæœ€å¤š3æ¬¡regenerateæœºä¼šã€‚

## ğŸ“‹ è®¾è®¡å†³ç­–ç¡®è®¤

### 1. å±•ç¤ºæ–¹å¼: **Tabæ ‡ç­¾é¡µæ¨¡å¼**
**ç†ç”±**: æœ€ç®€å•æ˜“æ“ä½œï¼Œæ˜¾çœ¼æ˜ç¡®
- æ¨ªå‘æ ‡ç­¾å¸ƒå±€ï¼Œä¸€ç›®äº†ç„¶
- ç‚¹å‡»åˆ‡æ¢ï¼Œæ“ä½œç›´è§‚
- è§†è§‰å±‚æ¬¡æ¸…æ™°

### 2. åˆ†æ”¯èŒƒå›´: **æ•´ä¸ªworkflowåˆ†æ”¯å±•ç¤º**
- é€‰æ‹©æŸç‰ˆæœ¬ç—›ç‚¹åï¼Œåç»­çš„revised pain pointã€content strategyã€final contentéƒ½åœ¨è¯¥åˆ†æ”¯å†…å±•ç¤º
- æ¯ä¸ªtabåŒ…å«å®Œæ•´çš„workflowæµç¨‹

### 3. ç‰ˆæœ¬å‘½å: **"ç‰ˆæœ¬1ã€ç‰ˆæœ¬2ã€ç‰ˆæœ¬3"**
- ç®€æ´æ˜ç¡®ï¼Œæ˜“äºç†è§£
- å¯¹åº”3æ¬¡regenerateæœºä¼š

### 4. é»˜è®¤è¡Œä¸º: **è‡ªåŠ¨åˆ‡æ¢åˆ°æ–°ç‰ˆæœ¬**
- æ–°ç”Ÿæˆç—›ç‚¹åè‡ªåŠ¨æ˜¾ç¤ºæœ€æ–°ç‰ˆæœ¬
- ä¿æŒç”¨æˆ·çœ‹åˆ°æœ€æ–°ç»“æœçš„æœŸæœ›

## ğŸ—ï¸ æŠ€æœ¯å®ç°æ–¹æ¡ˆ

### æ•°æ®ç»“æ„è®¾è®¡
```typescript
interface PainPointVersion {
  id: string;
  version: number;
  painPointMessages: Message[];
  workflowMessages: Message[]; // revised pain point + strategy + final content
  createdAt: Date;
}

interface BranchState {
  versions: PainPointVersion[];
  activeVersionId: string;
  regenerateCount: number; // 0-3
}
```

### UIç»„ä»¶æ¶æ„
1. **Tabå¯¼èˆªæ **: æ˜¾ç¤ºç‰ˆæœ¬æ ‡ç­¾å’Œåˆ‡æ¢åŠŸèƒ½
2. **åˆ†æ”¯å†…å®¹åŒº**: æ˜¾ç¤ºå½“å‰ç‰ˆæœ¬çš„å®Œæ•´workflow
3. **Regenerateæ§åˆ¶**: ç®¡ç†regenerateæ¬¡æ•°å’ŒæŒ‰é’®çŠ¶æ€

## âœ… éªŒæ”¶æ ‡å‡†
1. **ç‰ˆæœ¬éš”ç¦»**: æ¯ä¸ªç‰ˆæœ¬çš„ç—›ç‚¹å’Œworkflowç‹¬ç«‹å±•ç¤º
2. **Tabåˆ‡æ¢**: ç”¨æˆ·å¯åœ¨ç‰ˆæœ¬é—´æ— ç¼åˆ‡æ¢
3. **é™åˆ¶æ‰§è¡Œ**: æœ€å¤š3ä¸ªç‰ˆæœ¬ï¼Œç¬¬3æ¬¡åç¦ç”¨regenerate
4. **è‡ªåŠ¨åˆ‡æ¢**: æ–°ç‰ˆæœ¬ç”Ÿæˆåè‡ªåŠ¨åˆ‡æ¢åˆ°è¯¥ç‰ˆæœ¬
5. **å·¥ä½œæµå®Œæ•´**: æ¯ä¸ªç‰ˆæœ¬åŒ…å«å®Œæ•´çš„ç—›ç‚¹â†’revisedâ†’strategyâ†’finalæµç¨‹

## ğŸ”§ é›†æˆçº¦æŸ
- ä¿æŒç°æœ‰Dify APIè°ƒç”¨é€»è¾‘
- ä¸å½±å“éç—›ç‚¹é˜¶æ®µçš„æ¶ˆæ¯æ˜¾ç¤º
- å¤ç”¨ç°æœ‰çš„æ¶ˆæ¯ç»„ä»¶å’Œæ ·å¼
- ä¿æŒconversation IDç®¡ç†æœºåˆ¶